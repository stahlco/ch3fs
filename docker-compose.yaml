services:
  ch3f:
    build:
      context: .
      dockerfile: docker/Dockerfile
    ports:
      - "8081-8090:8080"
    restart: unless-stopped
    networks:
      - kitchen
    deploy:
      replicas: 10
      restart_policy:
        condition: on-failure
    volumes:
      - container_storage:/storage
      - /var/run/docker.sock:/var/run/docker.sock

  client:
    build: ./cmd
    networks:
      - kitchen
    depends_on:
      - ch3f

      
volumes:
  container_storage:
    driver: local
networks:
  kitchen:
    name: kitchen